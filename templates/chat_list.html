{% extends "base_new.html" %}

{% block title %}Contacts - Secure Chat{% endblock %}

{% block content %}
<div class="flex h-[calc(100vh-4rem)] -m-8">
  <section class="w-full max-w-sm border-r border-gray-200 bg-white">
    <div class="p-4 border-b border-gray-100">
      {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
      {% for category, message in messages %}
      <div
        class="mb-3 rounded-lg border px-3 py-2 text-sm {% if category == 'success' %}border-emerald-200 bg-emerald-50 text-emerald-700{% else %}border-blue-200 bg-blue-50 text-blue-700{% endif %}">
        {{ message }}
      </div>
      {% endfor %}
      {% endif %}
      {% endwith %}
      <label class="flex flex-col">
        <span class="text-sm font-medium text-gray-500 mb-2">Search members</span>
        <input class="form-input rounded-full border-gray-200 focus:border-primary focus:ring-primary"
          placeholder="Search (coming soon)" disabled />
      </label>
    </div>
    <div class="divide-y divide-gray-100">
      {% if users %}
      {% for user in users %}
      <a href="{{ url_for('chat', username=user.username) }}"
        class="flex items-center gap-3 px-4 py-4 hover:bg-gray-50">
        {% if user.profile_picture %}
        <img src="{{ url_for('static', filename='uploads/' + user.profile_picture) }}" alt="{{ user.username }}"
          class="w-10 h-10 rounded-full object-cover border border-gray-200">
        {% else %}
        <div
          class="w-10 h-10 rounded-full bg-primary/10 text-primary flex items-center justify-center font-heading uppercase">
          {{ user.username[:2] }}
        </div>
        {% endif %}
        <div class="flex-1">
          <p class="text-base font-semibold text-gray-900">{{ user.username }}</p>
          <p class="text-sm text-gray-500">Tap to open secure chat</p>
        </div>
        <span class="material-symbols-outlined text-gray-400">chevron_right</span>
      </a>
      {% endfor %}
      {% else %}
      <div class="p-6 text-center text-gray-500">
        No other users yet. Invite someone to register and start a secure chat.
      </div>
      {% endif %}
    </div>
  </section>

  <section
    class="flex-1 flex flex-col items-center justify-center bg-gradient-to-br from-white to-blue-50 text-center px-6">
    <h2 class="text-2xl font-semibold mb-3">Select a contact</h2>
    <p class="text-gray-600 max-w-md">
      Choose a user on the left to start an end-to-end encrypted conversation. Messages will appear here with the modern
      layout once a chat is active.
    </p>
  </section>
</div>
{% endblock %}